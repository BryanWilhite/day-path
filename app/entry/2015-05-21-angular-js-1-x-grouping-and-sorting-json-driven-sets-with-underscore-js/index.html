<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <meta name="description" content="my technical Blog ✒ for my studio" />
        <meta name="robots" content="index, follow" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <meta name="google-site-verification" content="MyXJp0qYgoTSi472GCarwPFWqvRZAo8khVV_FXV33tI" />
        <meta name="msvalidate.01" content="9C08B066B4967EBE515E0CC7C146DE30" />

        <base href="http://songhayblog.azurewebsites.net/" />

        <link rel="canonical" href="http://songhayblog.azurewebsites.net/" />
        <link rel="alternate" type="application/atom+xml" title="day path" href="/entry/feed.xml" />
        <link rel="SHORTCUT ICON" href="http://songhayblog.azurewebsites.net/image/favicon.ico" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
        <link href="http://songhayblog.azurewebsites.net/style/styles.min.css" rel="stylesheet" />

        <script src="http://songhayblog.azurewebsites.net/script/index.min.js"></script>

        <title>Angular JS 1.x: grouping and sorting JSON-driven sets with Underscore JS - day path</title>
    </head>

    <body class="mdc-typography">
        <header class="mdc-top-app-bar mdc-top-app-bar--short">
            <div class="mdc-top-app-bar__row">
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                    <a href="http://songhayblog.azurewebsites.net/" class="material-icons mdc-top-app-bar__navigation-icon">first_page</a>
                    <span class="mdc-top-app-bar__title">day path</span>
                </section>
                <section class="description mdc-top-app-bar__section mdc-top-app-bar__section--align-end">
                    my technical Blog ✒ for my studio
                </section>
            </div>
        </header>
        <main class="mdc-layout-grid" id="main-content">
            <section class="entry">

    <h1>Angular JS 1.x: grouping and sorting JSON-driven sets with Underscore JS</h1>
<p>The <a href="https://docs.angularjs.org/api/ng/filter/orderBy">Angular JS documentation</a> on <code>orderBy</code> surprisingly has all the information I need to sort data. It even shows how the <code>reverse</code> argument can be assigned to a variable. This allowed me to write markup like this:</p>
<pre><code class="language-html">&lt;div data-ng-repeat=&quot;i in groups | orderBy: 'groupName' : vm.indexGroupingSelected.sortDescending &quot;&gt;…&lt;/div&gt;
</code></pre>
<p>When I use the variable <code>vm</code>, I am conventionally telling myself (because I’m a Microsoft, <em>MVVM</em> guy) that I am using my Angular <em>View Model</em> in Controller Scope (<code>$scope.vm</code>). Since I would like to follow my conventions, it would make sense to have <code>data-ng-repeat=&quot;i in vm.groups… &quot;</code> but I’ve found that Angular does not see “dotted” objects in <code>ng-repeat</code> (there may be some 1.x release after <code>1.2.6 taco-salsafication</code> that fixes this)—so I have no choice but to use <code>$scope.groups</code>.</p>
<p>Now, the angular documentation does <em>not</em> talk about how to fill <code>$scope.groups</code>—to me this is an Underscore thing. I use <code>_.chain()</code> (with <code>pairs()</code> and <code>map()</code>) in <code>$scope.vm.setGroups()</code> to fill <code>$scope.groups</code>:</p>
<pre><code class="language-javascript">setGroups: function() {
    $scope.groups = _($scope.vm.data)
        .chain()
        .groupBy(this.indexGroupingSelected.value)
        .pairs()
        .map(function(i) {
            return {
                groupName: i[0],
                group: i[1]
            };
        })
        .value();
}
</code></pre>
<p>I need to use <code>pairs()</code> and <code>map()</code>) because the Underscore <code>_.groupBy()</code> function does <em>not</em> return an array; it returns a new object (which is weird to me—but I’m not a JavaScript scientist—see “<a href="http://songhayblog.azurewebsites.net/Entry/Show/underscore-js-grouping">Underscore.js Grouping in Angular JS</a>” for more details). So, <code>pairs()</code> gives me an array that I <code>map()</code> into an object that most compatible with Angular.</p>
<p>My two code blocks above use <code>$scope.vm.indexGroupingSelected</code>. My use of <em>Selected</em> in the name of this View Model property makes sense when we see this Angular declaration:</p>
<p><select
    data-ng-change='vm.setGroups()'
    data-ng-model="vm.indexGroupingSelected"
    data-ng-options="i as i.label for i in options">
</select></p>
<p>Declaring <code>ng-model</code> in a <code>select</code> element binds the currently selected option in <code>$scope.options</code>. Again, I notice that I cannot use <code>$scope.vm.options</code>—I <em>have to</em> use <code>$scope.options</code>. In my Angular Controller, I fill my options like this:</p>
<pre><code class="language-javascript">$scope.options = [{
    label: 'by Date',
    sortDescending: true,
    value: 'dateGroup'
}, {
    label: 'by Topic',
    sortDescending: false,
    value: 'topic'
}];
</code></pre>
<p>This use of <code>sortDescending</code> in the options is awesome to me. Because the Angular <code>orderBy</code> expression supports not only variables but also “dotting down” objects used as variables my life was made a bit easier. This Angular feature allows me to control sorting data in ascending or descending order *with *data.</p>
<p>Check out <a href="http://codepen.io/rasx/pen/XJYJye">the full CodePen</a>:</p>
<!-- cSpell:disable -->
<iframe height="265" style="width: 100%;" scrolling="no" title="Songhay Studio: Day Path Index JSON" src="https://codepen.io/rasx/embed/XJYJye?height=265&theme-id=0&default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true">
<p>See the Pen <a href='https://codepen.io/rasx/pen/XJYJye'>Songhay Studio: Day Path Index JSON</a> by Bryan Wilhite
(<a href='https://codepen.io/rasx'>@rasx</a>) on <a href='https://codepen.io'>CodePen</a>.</p>
</iframe>
<!-- cSpell:enable -->
<p>Or get <a href="https://gist.github.com/BryanWilhite/4dfb1564fe88dba16625">the GitHub gist</a>:</p>
<script src="https://gist.github.com/BryanWilhite/4dfb1564fe88dba16625.js"></script>
<p>My ideas about Angular grouping owe their existence to “<a href="http://odetocode.com/blogs/scott/archive/2013/08/08/group-and-display-data-with-underscore-and-angularjs.aspx">Group and Display Data with Underscore and AngularJS</a>” by K. Scott Allen. I wrote a <a href="http://codepen.io/rasx/pen/BjCkH">basic grouping CodePen</a> to understand what was going on there. Then, I added the ability to change the grouping with a select element in an <a href="http://codepen.io/rasx/pen/XJJKYX?editors=101">‘intermediate’ grouping CodePen</a>.</p>
<p>@<a href="https://twitter.com/BryanWilhite">BryanWilhite</a></p>


</section>
<section class="meta">
    <span class="entry-date"> <strong>incept date:</strong> EEEE, MMMM d, y </span>
</section>
        </main>
        <footer>
            <div class="col-sm-8">
                <p>
                    Last Reviewed:
                    2015-05-21T07:00:00.000Z
                </p>
                <p>
                    Another stone tribal move by <a class="welcome" href="http://songhaysystem.com/">Songhay System</a>
                </p>
            </div>
            <div class="col-sm-4">
                <a href="http://twitter.com/BryanWilhite" target="_blank" title="@BryanWilhite">
                    <span class="zocial twitter icon"></span>
                </a>
                <a href="http://songhayblog.azurewebsites.net/entry/feed.xml" target="_blank" title="Atom feed">
                    <span class="zocial rss icon"></span>
                </a>
            </div>
        </footer>
    </body>

</html>