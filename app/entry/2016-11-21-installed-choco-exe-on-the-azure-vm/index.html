<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <meta name="description" content="my technical Blog ✒ for my studio" />
        <meta name="robots" content="index, follow" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <meta name="google-site-verification" content="MyXJp0qYgoTSi472GCarwPFWqvRZAo8khVV_FXV33tI" />
        <meta name="msvalidate.01" content="9C08B066B4967EBE515E0CC7C146DE30" />

        <base href="http://songhayblog.azurewebsites.net/" />

        <link rel="canonical" href="http://songhayblog.azurewebsites.net/" />
        <link rel="alternate" type="application/atom+xml" title="day path" href="/entry/feed.xml" />
        <link rel="SHORTCUT ICON" href="http://songhayblog.azurewebsites.net/image/favicon.ico" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
        <link href="http://songhayblog.azurewebsites.net/style/styles.min.css" rel="stylesheet" />

        <script src="http://songhayblog.azurewebsites.net/script/index.min.js"></script>

        <title>Installed choco.exe on the Azure VM… - day path</title>
    </head>

    <body class="mdc-typography">
        <header class="mdc-top-app-bar mdc-top-app-bar--short">
            <div class="mdc-top-app-bar__row">
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                    <a href="http://songhayblog.azurewebsites.net/" class="material-icons mdc-top-app-bar__navigation-icon">first_page</a>
                    <span class="mdc-top-app-bar__title">day path</span>
                </section>
                <section class="description mdc-top-app-bar__section mdc-top-app-bar__section--align-end">
                    my technical Blog ✒ for my studio
                </section>
            </div>
        </header>
        <main class="mdc-layout-grid" id="main-content">
            <section class="entry">

    <h1>Installed choco.exe on the Azure VM…</h1>
<p>The internet tells me that <code>choco.exe</code> supports <em>updating</em> packages (while the standard PowerShell <code>PackageManagement</code> from Microsoft—formerly OneGet—does not). So the experiment is around the question, Can I use <code>choco.exe</code> with previously installed OneGet packages from the Chocolatey Provider?</p>
<p>Install choice:</p>
<pre><code class="language-console">iwr &lt;https://chocolatey.org/install.ps1&gt; -UseBasicParsing | iex
</code></pre>
<p>First of all, the install process of <code>choco.exe</code> threatens to move the old packages from <code>C:\Chocolatey</code> to <code>C:\ProgramData\chocolatey</code> as this excerpt from the installation warns:</p>
<pre><code class="language-console">Creating Chocolatey folders if they do not already exist.
WARNING: You can safely ignore errors related to missing log files when upgrading from a version of Chocolatey less than 0.9.9.
'Batch file could not be found' is also safe to ignore.
 'The system cannot find the file specified' - also safe.
chocolatey.nupkg file not installed in lib.
Attempting to locate it from bootstrapper.
PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
Attempting to upgrade 'C:\Chocolatey' to 'C:\ProgramData\chocolatey'.
WARNING: Copying the contents of 'C:\Chocolatey' to 'C:\ProgramData\chocolatey'.
This step may fail if you have anything in this folder running or locked.
If it fails, just manually copy the rest of the items out and then delete the folder.
WARNING: !!!! ATTN: YOU WILL NEED TO CLOSE AND REOPEN YOUR SHELL !!!!
WARNING: Not setting tab completion: Profile file does not exist at
'C:\Users\rasx\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
Chocolatey (choco.exe) is now ready.
You can call choco from anywhere, command line or powershell by typing choco.
Run choco /? for a list of functions.
You may need to shut down and restart powershell and/or consoles first prior to using choco.
WARNING: This action will result in Log Errors, you can safely ignore those.
 You may need to finish removing 'C:\Chocolatey' manually.
Attempting to remove 'C:\Chocolatey'. This may fail if something in the folder is being used or locked.
Ensuring chocolatey commands are on the path
Ensuring chocolatey.nupkg is in the lib folder
</code></pre>
<p>Here is the punch line: I never had a <code>C:\Chocolately</code> folder! My machine has a OneGet <code>C:\Packages</code> folder. However, the <code>choco.exe</code> installation appears to have successfully moved all Chocolatey packages from the folder to <code>C:\ProgramData\chocolatey</code>.</p>
<p>I find this command super-useful:</p>
<pre><code class="language-console">choco upgrade all -y --whatif
</code></pre>
<p>This what-if mode report gives me option to upgrade everything or be a bit extra-careful and upgrade packages one by one. Today, I am seeing this:</p>
<pre><code class="language-console">Chocolatey can upgrade 10/18 packages. 0 packages failed.
See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
</code></pre>
<p>Can upgrade:</p>
<ul>
<li>git v2.10.2</li>
<li>chocolatey-fosshub.extension v0.4.0</li>
<li>notepadplusplus v7.2</li>
<li>irfanview v4.42.0.20161101</li>
<li>mm-choco.extension v0.0.4</li>
<li>cloudberryexplorer.azurestorage v2.5.0.21</li>
<li>chocolatey-uninstall.extension v1.2.0</li>
<li>filezilla v3.22.2.2</li>
<li>git.install v2.10.2</li>
<li>notepadplusplus.install v7.2</li>
</ul>
<p>This is the other command that is super-useful:</p>
<pre><code class="language-console">choco list -localonly –all
</code></pre>
<p>This displays output like this:</p>
<pre><code class="language-console">Chocolatey v0.10.3
7zip.install 16.02.0.20160811
autohotkey.portable 1.1.24.02
autoit.commandline 3.3.14.2
ccleaner 5.24.5841
ccleaner 5.23.5808
chocolatey 0.10.3
chocolatey-core.extension 1.0
chocolatey-fosshub.extension 0.2.0
chocolatey-uninstall.extension 1.1.0
CloudBerryExplorer.AzureStorage 2.5.0.21
CloudBerryExplorer.AzureStorage 2.5.0.11
defraggler 2.21.993
filezilla 3.22.2.2
filezilla 3.22.1
git 2.10.2
git 2.10.1
git.install 2.10.2
git.install 2.10.1
irfanview 4.42.0.20160616
mm-choco.extension 0.0.3
NAnt 0.92.2
notepadplusplus 7.2
notepadplusplus.install 7.2
sysinternals 2016.08.29
24 packages installed.
</code></pre>
<p>There two things I am seeing in this output. First, I see that the upgrade functionality of <code>choco.exe</code> is not much better than the standard (OneGet) stuff because an update simply stacks a new version of the package next to the old one. This implies that I still have to manually uninstall the old package by version number (unless there is some kind of cool command-line option to avoid this) with this:</p>
<pre><code class="language-console">choco uninstall git git.install --version 2.10.1
</code></pre>
<p>The results I am seeing from this command does not make me feel great:</p>
<pre><code class="language-console">Chocolatey v0.10.3
Uninstalling the following packages:
git;git.install
git v2.10.1
Skipping auto uninstaller - No registry snapshot.
git.install not uninstalled. An error occurred during uninstall:
Unable to uninstall 'git.install 2.10.1' because 'git 2.10.1' depends on it.
Chocolatey uninstalled 1/2 packages. 1 packages failed.
See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
Failures
 - git.install (exited 1) - git.install not uninstalled. An error occurred during uninstall:
 Unable to uninstall 'git.install 2.10.1' because 'git 2.10.1' depends on it.I see now that I should have used the `--force` command-line option. To make matters worse, my uninstall command above apparently installed *all* versions of `git`. So I was forced to reinstall `git` to see it listed as a locally-installed package.
</code></pre>
<p>Today, Chocolatey is not a sweet experience—especially for any package paired with an <code>*.install</code> package. All of the unpaired packages were uninstalled as expected and this is list of locally installed packages:</p>
<pre><code class="language-console">Chocolatey v0.10.3
7zip.install 16.02.0.20160811
autohotkey.portable 1.1.24.02
autoit.commandline 3.3.14.2
ccleaner 5.23.5808
chocolatey 0.10.3
chocolatey-core.extension 1.0
chocolatey-fosshub.extension 0.2.0
chocolatey-uninstall.extension 1.1.0
CloudBerryExplorer.AzureStorage 2.5.0.11
defraggler 2.21.993
filezilla 3.22.1
git 2.10.2
git.install 2.10.2
irfanview 4.42.0.20160616
mm-choco.extension 0.0.3
NAnt 0.92.2
notepadplusplus 7.2
notepadplusplus.install 7.2
sysinternals 2016.08.29
19 packages installed.
</code></pre>
<p>Finally, I am assuming for the moment that I need to make sure that there is only <em>one</em> version of these packages <em>at all times</em> to avoid getting another class of errors:</p>
<pre><code class="language-console">chocolatey-core.extension 1.0
chocolatey-fosshub.extension 0.2.0
chocolatey-uninstall.extension 1.1.0
mm-choco.extension 0.0.3
</code></pre>
<h2>Related Links</h2>
<ul>
<li><a href="https://chocolatey.org/docs/commands-reference">Commands Reference</a></li>
<li><a href="https://blogs.msdn.microsoft.com/powershell/2016/09/29/powershellget-and-packagemanagement-in-powershell-gallery-and-github/">PowerShellGet and PackageManagement in PowerShell Gallery and GitHub</a></li>
</ul>
<p>@<a href="https://twitter.com/BryanWilhite">BryanWilhite</a></p>


</section>
<section class="meta">
    <span class="entry-date"> <strong>incept date:</strong> EEEE, MMMM d, y </span>
</section>
        </main>
        <footer>
            <div class="col-sm-8">
                <p>
                    Last Reviewed:
                    2016-11-22T05:36:12.270Z
                </p>
                <p>
                    Another stone tribal move by <a class="welcome" href="http://songhaysystem.com/">Songhay System</a>
                </p>
            </div>
            <div class="col-sm-4">
                <a href="http://twitter.com/BryanWilhite" target="_blank" title="@BryanWilhite">
                    <span class="zocial twitter icon"></span>
                </a>
                <a href="http://songhayblog.azurewebsites.net/entry/feed.xml" target="_blank" title="Atom feed">
                    <span class="zocial rss icon"></span>
                </a>
            </div>
        </footer>
    </body>

</html>