<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <meta name="description" content="my technical Blog ✒ for my studio" />
        <meta name="robots" content="index, follow" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <meta name="google-site-verification" content="MyXJp0qYgoTSi472GCarwPFWqvRZAo8khVV_FXV33tI" />
        <meta name="msvalidate.01" content="9C08B066B4967EBE515E0CC7C146DE30" />

        <base href="http://songhayblog.azurewebsites.net/" />

        <link rel="canonical" href="http://songhayblog.azurewebsites.net/" />
        <link rel="alternate" type="application/atom+xml" title="day path" href="/entry/feed.xml" />
        <link rel="SHORTCUT ICON" href="http://songhayblog.azurewebsites.net/image/favicon.ico" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
        <link href="http://songhayblog.azurewebsites.net/style/styles.min.css" rel="stylesheet" />

        <script src="http://songhayblog.azurewebsites.net/script/index.min.js"></script>

        <title>Using scriptcs to Generate EPUB XHTML - day path</title>
    </head>

    <body class="mdc-typography">
        <header class="mdc-top-app-bar mdc-top-app-bar--short">
            <div class="mdc-top-app-bar__row">
                <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
                    <a href="http://songhayblog.azurewebsites.net/" class="material-icons mdc-top-app-bar__navigation-icon">first_page</a>
                    <span class="mdc-top-app-bar__title">day path</span>
                </section>
                <section class="description mdc-top-app-bar__section mdc-top-app-bar__section--align-end">
                    my technical Blog ✒ for my studio
                </section>
            </div>
        </header>
        <main class="mdc-layout-grid" id="main-content">
            <section class="entry">

    <h1>Using scriptcs to Generate EPUB XHTML</h1>
<p>I am embarrassed to admit that I was unaware that <a href="https://en.wikipedia.org/wiki/EPUB">EPUB</a> is a highly successful application of <a href="https://en.wikipedia.org/wiki/XHTML">XHTML</a><em>outside</em> of the Web browser. It has been a standard of the <a href="https://en.wikipedia.org/wiki/International_Digital_Publishing_Forum">IDPF</a> for over a decade. My entry into the .NET Framework around 2003 was driven by <a href="https://msdn.microsoft.com/en-us/library/system.xml.xpath.xpathdocument(v=vs.110).aspx"><code>XPathDocument</code></a> which gave way to <code>XDocument</code> under <a href="https://msdn.microsoft.com/en-us/library/mt693062.aspx">LINQ to XML</a> (around 2007). My document-centric approach to the .NET Framework (coupled with my <a href="https://en.wikipedia.org/wiki/Desktop_publishing">Desktop publishing</a> background) makes me more than suited to develop a publishing pipeline for EPUB.</p>
<p>For my design, there were two critical elements missing for this pipeline: (i) <a href="https://code.visualstudio.com/Docs/languages/markdown">markdown</a> (in the Visual Studio Code environment) and (ii) <a href="http://scriptcs.net">scriptcs</a>. Visual Studio Code can be regarded as a “gateway drug” to the cross-platform editing culture of Atom which inspired me (along with Git cultural influences) to see markdown as the most primitive (archival) document format for general-purpose XHTML applications (under the shadow of <a href="https://en.wikipedia.org/wiki/Standard_Generalized_Markup_Language">SGML</a>). I now understand that <a href="https://daringfireball.net/projects/markdown/syntax">markdown</a> is a subset of HTML, making its relationship to EPUB direct (and, by the way, I now regard EPUB as the ‘open source’ alternative to <a href="https://en.wikipedia.org/wiki/Portable_Document_Format">PDF</a>).</p>
<p>My chosen technology to apply the XML-processing power of the .NET Framework in an open-source, cross-platform-ish way, is scriptcs. (Currently the scriptcs story on Linux is not quite there as we wait for .NET Standard and .NET Core develop.) <a href="https://github.com/glennblock">Glenn Block</a> of .NET MEF fame is the main dude behind scriptcs. You can listen to Glenn talk about “The Future of ScriptCS” in <a href="https://www.dotnetrocks.com/?show=1110">show #1110 of .NET Rocks!</a>. One of the key takeaways from this show is seeing scriptcs as an application of <a href="https://en.wikipedia.org/wiki/.NET_Compiler_Platform">Roslyn</a>.</p>
<h2>My Generate-EPUB <code>*.csx</code> script</h2>
<p>My EPUB pipeline starts with an EPUB “seed” based on the handmade set of files from <a href="http://www.ericmuss-barnes.com/">Eric Muss-Barnes</a>. His video, “<a href="https://www.youtube.com/watch?v=EiUMb7bgYeQ">How to Make an eBook EPUB File</a>,” was an instrumental <em>technical</em> introduction to EPUB, in full view of the real-world publishing market. Since this introduction, I do see <a href="https://github.com/IDPF/epub3-samples">a GitHub repository</a>, from the IDPF, full of EPUB samples. I will explore these samples and look for ways to build upon the Muss-Barnes base.</p>
<p>My scriptcs approach therefore is a combination of reading and editing the EPUB seed using publication metadata in a JSON file and a collection of XHTML templates. This automation starts with <code>generate-epub.csx</code>, intending to summarize the automation:</p>
<pre><code class="language-c#">#load &quot;scriptcs-epub-utility.csx&quot;
#load &quot;scriptcs-environment-utility.csx&quot;
#load &quot;scriptcs-markdown-utility.csx&quot;
#load &quot;publication-namespaces.csx&quot;
#load &quot;publication-context.csx&quot;
#load &quot;publication-chapter.csx&quot;
#load &quot;publication-daisy-consortium-ncx.csx&quot;
#load &quot;publication-idpf-package.csx&quot;
#load &quot;publication-oebps-text-biography.csx&quot;
#load &quot;publication-oebps-text-copyright.csx&quot;
#load &quot;publication-oebps-text-dedication.csx&quot;
#load &quot;publication-oebps-text-toc.csx&quot;

var csxRoot = EnvironmentUtility.GetScriptFolder();
var pubContext = new PublicationContext(csxRoot);
pubContext.GenerateMeta();
pubContext.GenerateChapters();
pubContext.WriteTitle();
pubContext.WriteToc();
pubContext.WriteCopyright();
pubContext.WriteBiography();
pubContext.WriteDedication();

Console.WriteLine(&quot;End of script.&quot;);
</code></pre>
<p>The screenshot below shows the layout of the EPUB assets (along with the print-publication assets) with respect to <code>generate-epub.csx</code> (in the <code>\scriptcs</code> folder) in my free, <em>private</em> Git repository hosted by Microsoft:</p>
<div style="text-align:center">
<p><a href="https://www.flickr.com/photos/wilhite/32775732780/in/dateposted-public/"><img src="https://farm4.staticflickr.com/3716/32775732780_9e4cca30be_z_d.jpg" alt="EPUB pipeline in Git repository" title="!*m82"></a></p>
</div>
<p>Assuming that I have a future, I will go into detail about this intent and this layout for the EPUB pipeline in subsequent Blog posts.</p>
<p>@<a href="https://twitter.com/BryanWilhite">BryanWilhite</a></p>


</section>
<section class="meta">
    <span class="entry-date"> <strong>incept date:</strong> EEEE, MMMM d, y </span>
</section>
        </main>
        <footer>
            <div class="col-sm-8">
                <p>
                    Last Reviewed:
                    2017-03-09T02:10:04.021Z
                </p>
                <p>
                    Another stone tribal move by <a class="welcome" href="http://songhaysystem.com/">Songhay System</a>
                </p>
            </div>
            <div class="col-sm-4">
                <a href="http://twitter.com/BryanWilhite" target="_blank" title="@BryanWilhite">
                    <span class="zocial twitter icon"></span>
                </a>
                <a href="http://songhayblog.azurewebsites.net/entry/feed.xml" target="_blank" title="Atom feed">
                    <span class="zocial rss icon"></span>
                </a>
            </div>
        </footer>
    </body>

</html>